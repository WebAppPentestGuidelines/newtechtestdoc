<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=" EDoS(Economic Denial of Sustainability) # 概要 # IDaaSをはじめとしたクラウドサービスでは、料金はそのサービスの利用に応じて課金される「従量課金制」を採用しています。このような従量課金を採用するサービスでは、課金がなされる要素が増加するごとに利用額が増加します。この特性を攻撃者が悪用することでサービス提供者がサービス継続を行うことができないレベルまで利用額を増加させる攻撃を、Economic Denial of Sustainability(以下 EDoSと呼称する)と呼びます。
本稿ではAmazon Cognitoを例に、このEDoSについて解説をしていきます。
原因 # 概要でも触れましたが、主な原因として「課金がなされる要素が増加させる」ことがEDoSを引き起こす原因となります。Amazon Cognito User Poolで外的要因でこの課金額を増加させる方法として、「月間のアクティブユーザー(MAU)の増加」が挙げられます。
このMAUはCognito User Poolに対して、サインインやサインアップ等の機能を利用したユーザーを1として加算され、100,000MAU以下の場合、1MAUあたり0.0055USD加算されます。
MAU MAUあたりの料金 ～ 100,000 0.0055USD 90万 0.0046USD 900万 0.00325USD 1,000万超 0.0025USD このような料金形態を取るCognito User Poolでは、Cognito User Poolのセルフサインアップが有効化されている際に、攻撃者が大量のユーザーを作成することでサービス提供者が意図しない形でMAUが増加し、料金として請求されます。
影響 # 意図しない利用料金の請求により、サービス提供を行うための予算が利用され、サービスの提供ができなくなる恐れがあります。
事例紹介 # 現時点では現実世界においてCognito User Poolをはじめとして、IDaaSを用いたEDoSや利用料金の増加は報告されていません。ただし、NHK厚生文化事業団が運営する寄付サイトへの偽計業務妨害事案をはじめとし、従量課金を行うサービスにおいて、意図しない課金のためサービスが停止した例や、実装の不備により異常な課金が発生した例は報告されています。
対策 # 対策としては、攻撃者のユーザー作成やログインの自動化を難しくすることで大量のユーザーの追加を防ぐことができるでしょう。
自動化を難しくする方法として、Custom authentication challengeやAWS WAF等のCognito User Poolの拡張機能を用い、reCaptchaの導入や、Lambdaトリガーを用いたEmailアドレスの検証とエイリアス利用の制限等が挙げられます。
学習方法/参考文献 # EDoS Attack: クラウド利用料金でサービスを止められるって本当？: Amazon Cognito User Pool "><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="EDoS(Economic Denial of Sustainability) - IDaaS"><meta property="og:description" content=" EDoS(Economic Denial of Sustainability) # 概要 # IDaaSをはじめとしたクラウドサービスでは、料金はそのサービスの利用に応じて課金される「従量課金制」を採用しています。このような従量課金を採用するサービスでは、課金がなされる要素が増加するごとに利用額が増加します。この特性を攻撃者が悪用することでサービス提供者がサービス継続を行うことができないレベルまで利用額を増加させる攻撃を、Economic Denial of Sustainability(以下 EDoSと呼称する)と呼びます。
本稿ではAmazon Cognitoを例に、このEDoSについて解説をしていきます。
原因 # 概要でも触れましたが、主な原因として「課金がなされる要素が増加させる」ことがEDoSを引き起こす原因となります。Amazon Cognito User Poolで外的要因でこの課金額を増加させる方法として、「月間のアクティブユーザー(MAU)の増加」が挙げられます。
このMAUはCognito User Poolに対して、サインインやサインアップ等の機能を利用したユーザーを1として加算され、100,000MAU以下の場合、1MAUあたり0.0055USD加算されます。
MAU MAUあたりの料金 ～ 100,000 0.0055USD 90万 0.0046USD 900万 0.00325USD 1,000万超 0.0025USD このような料金形態を取るCognito User Poolでは、Cognito User Poolのセルフサインアップが有効化されている際に、攻撃者が大量のユーザーを作成することでサービス提供者が意図しない形でMAUが増加し、料金として請求されます。
影響 # 意図しない利用料金の請求により、サービス提供を行うための予算が利用され、サービスの提供ができなくなる恐れがあります。
事例紹介 # 現時点では現実世界においてCognito User Poolをはじめとして、IDaaSを用いたEDoSや利用料金の増加は報告されていません。ただし、NHK厚生文化事業団が運営する寄付サイトへの偽計業務妨害事案をはじめとし、従量課金を行うサービスにおいて、意図しない課金のためサービスが停止した例や、実装の不備により異常な課金が発生した例は報告されています。
対策 # 対策としては、攻撃者のユーザー作成やログインの自動化を難しくすることで大量のユーザーの追加を防ぐことができるでしょう。
自動化を難しくする方法として、Custom authentication challengeやAWS WAF等のCognito User Poolの拡張機能を用い、reCaptchaの導入や、Lambdaトリガーを用いたEmailアドレスの検証とエイリアス利用の制限等が挙げられます。
学習方法/参考文献 # EDoS Attack: クラウド利用料金でサービスを止められるって本当？: Amazon Cognito User Pool "><meta property="og:type" content="article"><meta property="og:url" content="https://webapppentestguidelines.github.io/newtechtestdoc/docs/cloudsec/idaas/edos/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-02-28T19:27:42+09:00"><title>EDoS(Economic Denial of Sustainability) - IDaaS | WebApp Testing</title><link rel=manifest href=/newtechtestdoc/manifest.json><link rel=icon href=/newtechtestdoc/favicon.png type=image/x-icon><link rel=stylesheet href=/newtechtestdoc/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css integrity="sha256-xYKS02sYtnVoCrm66iApIEU3uDnqcvJYdG7A8yzo1sg=" crossorigin=anonymous><script defer src=/newtechtestdoc/flexsearch.min.js></script>
<script defer src=/newtechtestdoc/ja.search.min.b98c344b6de4f608bc6fd812551cc61370279d34ecd10f070a20509ef8ca8e18.js integrity="sha256-uYw0S23k9gi8b9gSVRzGE3AnnTTs0Q8HCiBQnvjKjhg=" crossorigin=anonymous></script>
<script defer src=/newtechtestdoc/sw.min.a87e9a69c1c9637cd6edeaed247d3a7735fae81f6bc6668f69a2cc0a283426ec.js integrity="sha256-qH6aacHJY3zW7ertJH06dzX66B9rxmaPaaLMCig0Juw=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/newtechtestdoc/><span>WebApp Testing</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=検索 aria-label=検索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/newtechtestdoc/docs/nosql_injection/>NoSQL Injection</a><ul></ul></li><li><a href=/newtechtestdoc/docs/oauth/>OAuth/OpenIDConnectの診断手法</a><ul></ul></li><li><a href=/newtechtestdoc/docs/prototype_pollution/>Prototype Pollution</a><ul></ul></li><li><a href=/newtechtestdoc/docs/toctou/>TOCTOU/レースコンディション</a><ul></ul></li><li><a href=/newtechtestdoc/docs/cloudsec/>クラウドサービスにおけるWebサービスにまつわる脆弱性</a><ul><li><a href=/newtechtestdoc/docs/cloudsec/idaas/>IDaaSの活用に起因する脆弱性とその悪用</a><ul><li><a href=/newtechtestdoc/docs/cloudsec/idaas/edos/ class=active>EDoS(Economic Denial of Sustainability) - IDaaS</a></li><li><a href=/newtechtestdoc/docs/cloudsec/idaas/modify_custom_attributes_for_permissions/>アプリケーションの権限に関するカスタム属性の変更 - IDaaS</a></li><li><a href=/newtechtestdoc/docs/cloudsec/idaas/default_error/>デフォルトエラーに起因するユーザーの開示 - IDaaS</a></li><li><a href=/newtechtestdoc/docs/cloudsec/idaas/presence_of_unintended_signup_paths/>意図しないサインアップ経路の存在 - IDaaS</a></li></ul></li><li><a href=/newtechtestdoc/docs/cloudsec/faas/>FaaSにおける設定不備と脆弱性の悪用</a></li><li><a href=/newtechtestdoc/docs/cloudsec/cloud_credential/>Webアプリケーションの脆弱性を利用した認証情報の窃取</a></li><li><a href=/newtechtestdoc/docs/cloudsec/storage_service/>クラウドストレージサービスにおける設定不備</a></li></ul></li><li><a href=/newtechtestdoc/docs/web_cache_poisoning/>Web Cache Poisoning</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/newtechtestdoc/svg/menu.svg class=book-icon alt=Menu></label>
<strong>EDoS(Economic Denial of Sustainability) - IDaaS</strong>
<label for=toc-control><img src=/newtechtestdoc/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#概要>概要</a></li><li><a href=#原因>原因</a></li><li><a href=#影響>影響</a></li><li><a href=#事例紹介>事例紹介</a></li><li><a href=#対策>対策</a><ul><li></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=edoseconomic-denial-of-sustainability>EDoS(Economic Denial of Sustainability)
<a class=anchor href=#edoseconomic-denial-of-sustainability>#</a></h1><h2 id=概要>概要
<a class=anchor href=#%e6%a6%82%e8%a6%81>#</a></h2><p>IDaaSをはじめとしたクラウドサービスでは、料金はそのサービスの利用に応じて課金される「従量課金制」を採用しています。このような従量課金を採用するサービスでは、課金がなされる要素が増加するごとに利用額が増加します。この特性を攻撃者が悪用することでサービス提供者がサービス継続を行うことができないレベルまで利用額を増加させる攻撃を、Economic Denial of Sustainability(以下 EDoSと呼称する)と呼びます。</p><p>本稿ではAmazon Cognitoを例に、このEDoSについて解説をしていきます。</p><h2 id=原因>原因
<a class=anchor href=#%e5%8e%9f%e5%9b%a0>#</a></h2><p>概要でも触れましたが、主な原因として「課金がなされる要素が増加させる」ことがEDoSを引き起こす原因となります。Amazon Cognito User Poolで外的要因でこの課金額を増加させる方法として、「月間のアクティブユーザー(MAU)の増加」が挙げられます。</p><p>このMAUはCognito User Poolに対して、サインインやサインアップ等の機能を利用したユーザーを1として加算され、100,000MAU以下の場合、1MAUあたり0.0055USD加算されます。</p><table><thead><tr><th style=text-align:center>MAU</th><th style=text-align:center>MAUあたりの料金</th></tr></thead><tbody><tr><td style=text-align:center>～ 100,000</td><td style=text-align:center>0.0055USD</td></tr><tr><td style=text-align:center>90万</td><td style=text-align:center>0.0046USD</td></tr><tr><td style=text-align:center>900万</td><td style=text-align:center>0.00325USD</td></tr><tr><td style=text-align:center>1,000万超</td><td style=text-align:center>0.0025USD</td></tr></tbody></table><p>このような料金形態を取るCognito User Poolでは、Cognito User Poolのセルフサインアップが有効化されている際に、攻撃者が大量のユーザーを作成することでサービス提供者が意図しない形でMAUが増加し、料金として請求されます。</p><h2 id=影響>影響
<a class=anchor href=#%e5%bd%b1%e9%9f%bf>#</a></h2><p>意図しない利用料金の請求により、サービス提供を行うための予算が利用され、サービスの提供ができなくなる恐れがあります。</p><h2 id=事例紹介>事例紹介
<a class=anchor href=#%e4%ba%8b%e4%be%8b%e7%b4%b9%e4%bb%8b>#</a></h2><p>現時点では現実世界においてCognito User Poolをはじめとして、IDaaSを用いたEDoSや利用料金の増加は報告されていません。ただし、<a href=https://www.yomiuri.co.jp/national/20220628-OYT1T50078/>NHK厚生文化事業団が運営する寄付サイトへの偽計業務妨害事案</a>をはじめとし、従量課金を行うサービスにおいて、意図しない課金のためサービスが停止した例や、実装の不備により異常な課金が発生した例は報告されています。</p><h2 id=対策>対策
<a class=anchor href=#%e5%af%be%e7%ad%96>#</a></h2><p>対策としては、攻撃者のユーザー作成やログインの自動化を難しくすることで大量のユーザーの追加を防ぐことができるでしょう。</p><p>自動化を難しくする方法として、<a href=https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-challenge.html>Custom authentication challenge</a>やAWS WAF等のCognito User Poolの拡張機能を用い、reCaptchaの導入や、Lambdaトリガーを用いたEmailアドレスの検証とエイリアス利用の制限等が挙げられます。</p><h4 id=学習方法参考文献>学習方法/参考文献
<a class=anchor href=#%e5%ad%a6%e7%bf%92%e6%96%b9%e6%b3%95%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae>#</a></h4><ul><li><a href=https://blog.flatt.tech/entry/edos_aws#Amazon-Cognito-User-Pool>EDoS Attack: クラウド利用料金でサービスを止められるって本当？: Amazon Cognito User Pool</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/WebAppPentestGuidelines/newtechtestdoc/commit/dbbfabd31b00ec0959042826f765b5ec8febedeb title='最終更新者 a-zara-n | February 28, 2023' target=_blank rel=noopener><img src=/newtechtestdoc/svg/calendar.svg class=book-icon alt=Calendar>
<span>February 28, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#概要>概要</a></li><li><a href=#原因>原因</a></li><li><a href=#影響>影響</a></li><li><a href=#事例紹介>事例紹介</a></li><li><a href=#対策>対策</a><ul><li></li></ul></li></ul></nav></div></aside></main></body></html>